# sf_project
Проект посвящён применению методов компьютерного зрения для мониторинга популяции бездомных собак в городской среде на основе анализа фотографий улиц. Задача рассматривается как объектная детекция: на вход подаётся изображение, на выходе модель должна определить, присутствуют ли на нём бездомные собаки, и, если да, — локализовать их с помощью ограничивающих прямоугольников. С практической точки зрения, такая система может использоваться как муниципальными службами и приютами для оценки численности и распределения бездомных собак по районам, так волонтёрскими организациями для мониторинга «горячих точек» концентрации животных, а также в составе городских аналитических панелей для поддержки решений по стерилизации, вакцинации и повышению безопасности людей и животных. Система может обрабатывать потоки изображений с камер и автоматически строить карту распределения бездомных собак по территории города. Это даёт количественные оценки, возможность выявлять новые «очаги» и оперативно на них реагировать, а также основу для принятия решений о размещении приютов, точек кормления, стерилизации и профилактических мероприятий. Проект демонстрирует, как готовые предобученные модели компьютерного зрения могут быть адаптированы под конкретную социально-экологическую задачу и встроены в более широкий контур принятия решений.
Классические подходы к оценке численности бездомных животных опираются на ручные обходы, опросы и отдельные наблюдения. Это затрачивает много труда, плохо масштабируется на большие города и не даёт оперативной картины изменений. Современные методы Deep Learning для компьютерного зрения позволяют автоматизировать анализ визуальных данных с камер наблюдения, дронов и мобильных устройств. В частности, задачи object detection позволяют:
○ одновременно решать классификацию (есть собака или её нет) и локализацию (координаты объекта на изображении);
○ строить временные и пространственные распределения по результатам детекции (например, подсчёт собак по районам и по дням).
Использование предобученной модели с последующим fine tuning на специализированном датасете:
○ снижает требования к объёму размеченных данных;
○ ускоряет обучение;
○ часто даёт лучшую обобщающую способность по сравнению с обучением "с нуля".
В проекте используется модель YOLOv8n из библиотеки Ultralytics — современная архитектура для объектной детекции, обученная на крупном наборе данных COCO.Документация и веса: https://docs.ultralytics.com/models/yolov8/
С точки зрения data science и инженерии модель предоставляет значительные преимущества:
○ скорость и точность: YOLOv8 обеспечивает хороший баланс между качеством детекции и скоростью инференса, что важно для потенциальной онлайн обработки потоков с камер;
○ предобученные веса: модель уже обучена на COCO, где есть класс dog. Это означает, что модель знает, как выглядят собаки в самых разных условиях, и для адаптации под бездомных собак достаточно дообучения на специализированном датасете;
○ удобный API: библиотека Ultralytics предоставляет единый интерфейс для обучения, оценки и инференса, что уменьшает инженерные накладные расходы и позволяет сосредоточиться на постановке задачи и анализе результатов;
○ экосистема и документация: есть подробная документация и большое количество примеров, включая обучение на пользовательских датасетах, что делает модель подходящей для учебных и демонстрационных проектов.
В проекте YOLOv8n используется как внешняя предобученная модель, которая затем fine tune’ится на данных бездомных собак, реализуя сценарий transfer learning. Для обучения и оценки модели используется специализированный датасет детекции бездомных собак. Страница датасета: https://universe.roboflow.com/street-dog-detection/stray-dogs-detection-hjxop в формате YOLOv8. Датасет загружается через API Roboflow.
Выражаясь языком DS терминов, проект можно описать следующим образом: 
○ тип задачи: задача объектной детекции;
○ входные данные: RGB изображения (уличные сцены);
○ выход модели: набор детекций (x1, y1, x2, y2, p, c), где (x1, y1, x2, y2) — координаты ограничивающего прямоугольника, p — вероятность/уверенность модели, c — предсказанный класс (бездомная собака);
○ цель обучения: минимизировать ошибку детекции, измеряемую метриками уровня object detection — прежде всего mAP (mean Average Precision) при разных порогах IoU, а также Precision/Recall;
Проект состоит из следующих этапов: 
○ импорт необходимых библиотек и датасета; 
○ использование предобученной модели и ее fine-tuning; 
○ оценка и инференс;
○ демонстрация результатов.
Каждый из этапов отражён в colab-блокноте. Для начала работы необходимо открыть ноутбук из репозитория (либо через кнопку "Open in Colab" на GitHub, либо загрузив его в Colab вручную), затем последовательно выполнить ячейку с установкой зависимостей, которая устанавливает все необходимые библиотеки, включая ultralytics, roboflow и инструменты для визуализации. После установки зависимостей нужно получить персональный API‑ключ в Roboflow, вставить его в соответствующую ячейку и запустить код, который скачает датасет в формате YOLOv8 и подготовит структуру папок с train/valid/test, или же воспользоваться уже готовым датасетом, ссылка на который давалась выше. Далее запускается ячейка с обучением модели YOLOv8 на загруженном датасете; при необходимости можно изменить количество эпох и другие гиперпараметры прямо в аргументах функции train. Когда обучение завершится, ноутбук позволяет выполнить инференс: модель прогоняет пользовательские фотографии, загруженные через виджет загрузки файлов в Colab, строит предсказания и визуализирует результат с рамками вокруг собак и подписями классов с вероятностями. Для использования своих изображений достаточно загрузить один или несколько файлов, после чего выполнить ячейку с инференсом по пользовательской папке — на выходе в ноутбуке отобразятся картинки с обведёнными объектами, а также будут сохранены результаты в стандартной папке runs/detect.
Модель была проверена на трёх изображениях, взятых из сети Интернет. Предсказание дало в целом точные результаты. В будущем модель можно улучшить в нескольких направлениях. Во-первых, принципиально важным может быть не только детекция на изображении собаки, но и принципиальные различия между собакой бездомной и собакой гуляющей, у которой есть хозяин в непосредственной близости, во избежание некорректности данных. Во-вторых, модель может выявлять у собак признаки потенциально опасных заболеваний, таких как бешенство, и позволять создавать карантинные зоны до того момента, когда появится большое количество жертв. 

